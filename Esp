-- ESP PLAYERS, HITBOX - YİLDİRAY HUB
local Players = game:GetService("Players")
local player = Players.LocalPlayer
local madebyYildiray = true -- rznnq -> Yildiray
local espConnections = {}

local function createESP(plr)
    if plr == player then return end
    if not plr.Character then return end
    if plr.Character:FindFirstChild("followme@Yildiray") then return end
    
    local char = plr.Character
    local hrp = char:FindFirstChild("HumanoidRootPart")
    local head = char:FindFirstChild("Head")
    if not (hrp and head) then return end
    
    -- HİTBOX (GRİ RENK YAPILDI)
    local hitbox = Instance.new("BoxHandleAdornment")
    hitbox.Name = "followme@Yildiray"
    hitbox.Adornee = hrp
    hitbox.Size = Vector3.new(4, 6, 2)
    hitbox.Color3 = Color3.fromRGB(150, 150, 150) -- Gri
    hitbox.Transparency = 0.6
    hitbox.ZIndex = 10
    hitbox.AlwaysOnTop = true
    hitbox.Parent = char
    
    -- İSİM ETİKETİ (SARI RENK YAPILDI)
    local billboard = Instance.new("BillboardGui")
    billboard.Name = "YildirayHub_ESP"
    billboard.Adornee = head
    billboard.Size = UDim2.new(0, 200, 0, 50)
    billboard.StudsOffset = Vector3.new(0, 3, 0)
    billboard.AlwaysOnTop = true
    billboard.Parent = char
    
    local label = Instance.new("TextLabel")
    label.Size = UDim2.new(1, 0, 1, 0)
    label.BackgroundTransparency = 1
    label.Text = plr.DisplayName or plr.Name
    label.TextColor3 = Color3.fromRGB(255, 215, 0) -- Sarı
    label.Font = Enum.Font.Arcade
    label.TextScaled = true
    label.TextStrokeTransparency = 0.5
    label.TextStrokeColor3 = Color3.fromRGB(0, 0, 0) -- Siyah gölge (Sarıyı belli eder)
    label.Parent = billboard
end

local function removeESP(plr)
    if not plr.Character then return end
    -- rznnq etiketleri yerine yeni isimler kontrol ediliyor
    local hitbox = plr.Character:FindFirstChild("followme@Yildiray")
    local nameGui = plr.Character:FindFirstChild("YildirayHub_ESP")
    if hitbox then hitbox:Destroy() end
    if nameGui then nameGui:Destroy() end
end

local function enableESP()
    for _, plr in ipairs(Players:GetPlayers()) do
        if plr ~= player then
            if plr.Character then
                createESP(plr)
            end
            local conn = plr.CharacterAdded:Connect(function()
                task.wait(0.1)
                if madebyYildiray then
                    createESP(plr)
                end
            end)
            table.insert(espConnections, conn)
        end
    end
    
    local playerAddedConn = Players.PlayerAdded:Connect(function(plr)
        if plr == player then return end
        local charAddedConn = plr.CharacterAdded:Connect(function()
            task.wait(0.1)
            if madebyYildiray then
                createESP(plr)
            end
        end)
        table.insert(espConnections, charAddedConn)
    end)
    table.insert(espConnections, playerAddedConn)
end

local function disableESP()
    for _, plr in ipairs(Players:GetPlayers()) do
        removeESP(plr)
    end
    for _, conn in ipairs(espConnections) do
        if conn and conn.Connected then
            conn:Disconnect()
        end
    end
    espConnections = {}
end

-- Karakter değişince yenileme
player.CharacterAdded:Connect(function()
    task.wait(0.1)
    if madebyYildiray then
        enableESP()
    else
        disableESP()
    end
end)

if madebyYildiray then
    enableESP()
end
